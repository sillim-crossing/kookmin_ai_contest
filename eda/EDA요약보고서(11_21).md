# 📦 Dacon 무역품목 공행성 대회 — Raw Data EDA 총괄 요약본  
**(Data Engineer 관점 / 모델·특징공학 금지 / Raw 구조만 분석)**

---

# 1. 데이터 구조 개요

## 1-1. 파일 구성 및 스키마

train.csv 구조:

| column   | 의미 |
|----------|------|
| item_id  | 품목 ID (문자열, HS4 기반) |
| year     | 연도 |
| month    | 월 |
| seq      | 내부 row sequence |
| type     | type 구분 (의미 미공개) |
| hs4      | item_id 앞 4자리 HS4 code |
| weight   | 무게 |
| quantity | 수량 |
| value    | 금액 |
| date     | year-month 결합 시계열 |

**패널타임 구조**  
- 100개 품목 × 43개월 → **완전 패널(timestamp 동일)**  
- 누락 월 없음 → 시계열 분석·상관 분석·lag 분석 모두 가능  

---

# 2. 결측치·0값 기본 품질 진단

## 2-1. Missing Summary (Step2)

```text
missing_count / missing_ratio (모든 컬럼)
item_id, year, month, seq, type, hs4, weight, quantity, value, date  
→ 모두 missing 0건, missing_ratio 0.0
```

### ✔ 결측치가 전혀 없음  
→ 별도의 결측 보간/삭제 로직 필요 없음  
→ 바로 정적/동적 상관·시계열 탐색 가능

---

## 2-2. 0값 비율

```text
0 values in value:    5.8693%
0 values in weight:   8.6286%
0 values in quantity: 82.3090%
```

### ✔ quantity는 82%가 0  
→ 실제 모델링에서 **정보가 거의 없음**  
→ 경쟁모델들이 quantity를 거의 쓰지 않는 이유 설명됨

### ✔ value ≈ 6%, weight ≈ 9% 0  
→ "0 = 실무적 의미(거래 없음)"로 해석 가능

---

# 3. 기본 분포 및 극단치(Outlier)

## 3-1. 기술통계

| 변수 | mean | std | min | 50% | max |
|------|------|------|------|-------|--------|
| value | 1.7M | 5.4M | 0 | 125k | 111M |
| weight | 1.09M | 5.15M | 0 | 6.5k | 110M |
| quantity | 86k | 7.6M | 0 | 0 | 792M |

### ✔ value·weight·quantity 모두 강한 **positively skewed**(오른쪽 꼬리 극단치)

→ 품목 내 분산이 매우 크고,  
→ 그래프 기반 공행성 계산 시 **극단치가 상관계수 왜곡하는 구조** 존재  

---

# 4. 시계열 구조 분석

## 4-1. 전체 Total Value 시계열

📉 **2022~2025 전체적으로 완만한 하락 추세**  
→ 글로벌 환경 요인 반영 가능  
→ 품목 간 동조적 하향 압력(Downward Co-movement) 존재 가능성

## 4-2. STL 분해(sample item)

### ✔ Trend  
- 초반 완만 상승 → 후반부 큰 하락 → 최근 약한 반등  

### ✔ Season  
- 월별 시즌 패턴 거의 없고 노이즈성 구조가 큼  
→ “계절성 기반 공행성”은 거의 의미 없음  
→ **추세·shock 기반 공행성만 의미 있음**

### ✔ Resid  
- 강한 변동성 클러스터링(volatility clustering)  
→ 외부 충격이 여러 품목에 동시 작동할 가능성

---

# 5. Cross-section(100개 품목) Correlation & Clustering

## 5-1. Correlation Pair Top20

```text
RJCAXSGH – KFQSHBNH : 0.9077
XIIEJNEE – IGDVVKUD : 0.8196
QRKRBYJL – SDWAYPIK : 0.7942
…
ATLDMDBO – XUOIQPFL : 0.7075
```

### ✔ 상관 0.7~0.9 매우 강한 쌍들 실제 존재  
→ 공행성 ground-truth 유추에 중요  
→ 표면상 “랜덤 100개 item_id” 같지만 **내부 구조적 군집 존재 확정**

## 5-2. Correlation Heatmap (first 50개)

### ✔ diagonal(자기상관) 제외 전체적으로 약−중정도 상관만 흩어져 있음  
→ "전체적으로 느슨한 네트워크 + 부분 강결합 subgraph" 구조

## 5-3. Hierarchical Dendrogram

- 50개 샘플만 봐도 품목은 **3~4개의 메가 클러스터**로 나뉨  
- HS4 기반 분류와 상당부분 유사한 경향 보임  

---

# 6. HS4 기반 품목 구조

## 6-1. Value 총합 기준 TOP HS4

```text
FCYB : 4.67B  
ATLD : 2.58B  
GYHK : 1.45B  
…
XUOI : 0.196B
```

### ✔ 시장 규모가 HS4마다 극단적으로 다름  
→ 공행성 관찰시 **대형군(HS4)을 중심축으로 한 종속구조**가 존재 가능성 높음  

## 6-2. HS4별 평균·표준편차

- FCYB: mean 36M, std 6M → 안정적 대규모 품목  
- ATLD: mean 20M, std 17M → 대규모+초고변동 품목  
- LRVG: std 8.4M → 초고변동군  
- HS4끼리도 구조적 차이가 존재 → 공행성 원인 분석에 기여

### ✔ EDA 결론  
**HS4 단위로 macro cluster가 존재하며, 품목 간 공행성의 상위 요인이 HS4인 경우가 많다.**

---

# 7. 네트워크 기반 공행성 구조

## 7-1. 그래프 구조 요약

```
간선 수: 5375 (100 nodes 기준 매우 많은 편)
```

→ corr≥0.3 / lag≥0.2 기준에서도  
→ **품목 간 관계선이 조밀하게 형성**됨

## 7-2. 중심성 Top5

```text
YSYHGLQK : betweenness 0.890  
VUAFAIYJ : 0.886  
SAHWCZNH : 0.818  
XUOIQPFL : 0.810  
ELQGMQWE : 0.742
```

### ✔ 네트워크 상 “허브 역할”을 하는 품목들 존재  

- 전체 shock을 다른 품목으로 전달하는 중심 노드  
- 공행성 pair 예측에서 hub들은 false positive·false negative 위험이 큼  

## 7-3. 네트워크 시각화 문제점(= 현재 한계점)

- 실제 그래프가 너무 dense → 시각적 구분 불가  
- edge too many → networkx 기본 spring layout로는 구조 파악 불가능  
- weight 기반 edge filtering 필요  
- community detection 추가 필요  

---

# 8. 패턴 기반 공행성 구조(부호 + 변화폭 카테고리)

## 8-1. 6개월 chunk 패턴 Top10

```text
-B+D+D : 7회  
-A+E+E : 4회  
+C-C-C : 4회  
-C-C+C : 3회  
+D+C-B : 2회  
…
```

### ✔ 시계열 패턴에도 의미 있는 구조 존재  
- 특정 품목들은 상승-하락-상승 같은 **반복적 모양 패턴**을 공유  
- 값(level) 기반 상관과 별개로 **shape 기반 패턴 공행성**이 존재  

## 8-2. 패턴 기반 Pair Overlap (추가 분석 예정)

(현재 본격적 계산은 안 했으나 EDA 코드상 수행 가능)

### 기대되는 현상  
- HS4가 같은 품목들끼리 패턴 유사도가 높을 가능성  
- 극단적 변동품목(LRVG 등)끼리 pattern-set Jaccard 높을 가능성  
- shape 공행성은 값(level) 공행성과 다른 관계를 보일 가능성

---

# 9. 종합 정리 — 데이터 엔지니어 관점 핵심 인사이트 10개

1. **결측치 0 → 데이터 품질 매우 좋음, 패널 완전성 100%**  
2. **시계열 초단기(43개월) → 계절성 거의 없음, shape 기반 공행성만 유효**  
3. **극단적 분포(heavy skew) → 상관 분석 왜곡 가능성 크다**  
4. **0값 구조(특히 quantity) → 실무적 의미의 “거래 없음” 신호**  
5. **HS4가 명확한 macro cluster 형성 → 공행성 상위 요인**  
6. **품목 간 correlation은 전체적으로 낮으나 일부 pair는 매우 높다(0.9↑)**  
7. **네트워크는 조밀하지만 중심 허브는 아주 명확히 존재**  
8. **lag-corr도 의미 있음 → 선행→후행 구조 존재 가능성**  
9. **패턴 기반 shape 공행성은 값 기반 상관과 또 다른 구조 제공**  
10. **Raw EDA 관점에서 공행성 신호는 데이터 내부에 실제 존재함이 확정**

---

# 10. 향후 분석/시도해야 할 방향(Feature 아님! 모델 관여 아님!)

이 항목은 **데이터 엔지니어로서 “추가 분석만” 제안**하는 것이며  
모델 구조·feature 제안 아님.

### ✔ 1) HS4 → item 구조의 명확한 community detection  
- Louvain / Leiden 등 그래프 커뮤니티 알고리즘 적용  
- correlation + lag + volatility 기반 가중치 조정  

### ✔ 2) 시계열 shape 기준 DTW-distance matrix  
→ 값 크기(scale) 무시하고 shape 공행성만으로 cluster 파악  

### ✔ 3) extreme volatility 품목(top value_diff) 기반 shock cascade 분석  
→ hub node에서 shock가 어떻게 전파되는지 확인  

### ✔ 4) pair-wise pattern Jaccard matrix 생성  
→ 패턴 기반 공행성 네트워크 생성 가능  

### ✔ 5) non-stationarity 대비 rolling correlation 분석  
→ 특정 구간에서만 strong pair 발생하는지 검증  

---

# 11. 결론

### **이 데이터는 공행성(leading→following)의 실제 구조를 내재하고 있다.**  
- correlational  
- lag based  
- shape(pattern) based  
- HS4 macro-cluster based  

즉, Raw EDA 차원에서  
**공행성쌍을 유추 가능하게 만드는 통계적 근거가 충분히 존재함**이 확인되었다.

(모델·feature는 동료 파트가 수행)

---

